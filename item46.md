# Item46. 타입 선언과 관련된 세가지 버전 이해하기



요약:

1. 의존성에 관련된 버전은 세가지: 라이브러리 버전, @types 버전, 타입스크립트 버전
2. 라이브러리 업데이트 -> @types도 업데이트해야함
3. 타입선언 두가지: 
   1. 라이브러리에 번들링하여 포함하기
   2. DefinitelyTyped에 공개하기





## 타입스크립트를 사용할 때 고려해야할 사항들

- 라이브러리의 버전
- 타입선언(@types) 버전
- 타입스크립트 자체의 버전





세 가지 버전중 하나라도 잘못되면 문제가 생긴다.



일반적으로 라이브러리는 dependencies로 설치, 타입 정보는 devDependencies로 설치한다.



```
npm install react
+ reat@16.8.6

npm install --save-dev @types/react
+ @types/react@16.8.19
```



마이너 버전까지는 일치하지만, 패치 버전은 일치하지 않고 있다. 시맨틱 버전 규칙을 지킨다면, 패치 버전은 공개 api의 스펙을 변경하지 않는다. 그러므로 타입 선언을 업데이트 할 필요가 없다.



하지만 이렇게 별도로 버전을 관리하면 다음의 문제가 생길 수 있다.

1. 실수로 타입선언을 업데이트 하지 않을 수 있다. -> 업데이트를 하면됨

   만일 아직 업데이트된 타입선언 버전이 없을 경우

   1. 보강기법으로 새 함수와 메서드의 타입 정보를 프로젝트 자체에 추가
   2. 타입 선언의 업데이트를 직접 작성하고 깃헙에 올리기

2. 라이브러리보다 타입 선언의 버전이 나중일때

   1. 라이브러리 버전을 올리거나 타입 선언의 버전을 내리기

3. 프로젝트 타입스크립트보다 라이브러리가 사용하는 타스 버전이 최신일 경우 -> 타스는 최신버전을 쓰자

   1. 해결법: 타스를 최신버전으로
   2. 라이브러리 타입 선언 버전을 낮추기
   3. Declare module선언으로 라이브러리의 타입 정보를 없애기
   4. @types 의존성이 중복되는 경우 -> `npm ls @types/foo` 이렇게 버전을 추적하여 버전을 맞춘다



타입스크립트 특정버전 설치하는법

```
npm install --save-dev @types/lodash@ts3.1


// 골뱅이 붙이고 버전을 명시하면 된다.
```



## 타입선언을 포함한 경우의 단점 4가지



1. 번들된 타입 선언에 보강 기법으로 해결할 수 없는 오류가 있는 경우 -> 타입 선언의 버전 선택의 방법없음
2. 프로젝트 내의 타입 선언이 다른 라이브러리의 타입 선언에 의존하게 되면 문제
3. 프로젝트의 과거 버전에 있는 타입 선언에 문제가 있는 경우 -> 과거 버전으로 돌아가서 패치 업데이트를 해줘야함
4. 패치를 자주 못함



## 라이브러리를 공개하려면 



타입선언에는 두가지 방법이 있다.

1. 타입선언을 자체적으로 포함하기
2. 타입정보만 분리해 DefinitelyTyped에 공개하기



타스로 작성한 것만 라이브러리에 포함하고 아니면 커뮤니티에게 관리를 맡기자

